<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat AI - Foam AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body class="bg-gray-100 h-screen">
    <div class="container mx-auto h-full flex">
        <!-- Sidebar with conversations -->
        <div class="w-1/4 bg-white border-r border-gray-200 flex flex-col">
            <div class="p-4 border-b border-gray-200">
                <h2 class="text-lg font-semibold text-gray-800">Conversaciones</h2>
                <button id="new-conversation-btn" class="mt-2 w-full bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition">
                    Nueva Conversación
                </button>
            </div>
            <div id="conversations-list" class="flex-1 overflow-y-auto">
                <!-- Conversations will be loaded here -->
            </div>
        </div>

        <!-- Main chat area -->
        <div class="flex-1 flex flex-col">
            <!-- Chat header -->
            <div class="bg-white p-4 border-b border-gray-200 shadow-sm">
                <div id="chat-header" class="flex items-center justify-between">
                    <div>
                        <h1 class="text-xl font-semibold text-gray-800">Chat AI</h1>
                        <p class="text-sm text-gray-600" id="conversation-title">Selecciona una conversación o crea una nueva</p>
                    </div>
                    <div class="text-sm text-gray-500 flex items-center space-x-2">
                        <span>Bot: <span id="current-bot">No seleccionado</span></span>
                        <div id="config-status" class="flex items-center">
                            <span class="w-2 h-2 bg-red-500 rounded-full mr-1" id="status-indicator"></span>
                            <span class="text-xs" id="status-text">Sin configurar</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Messages area -->
            <div id="messages-container" class="flex-1 overflow-y-auto p-4 space-y-4">
                <div class="text-center text-gray-500 mt-10">
                    <p>¡Bienvenido al Chat AI!</p>
                    <p class="text-sm mt-2">Configura tu API Key y Bot ID para comenzar</p>
                </div>
            </div>

            <!-- Input area -->
            <div class="bg-white border-t border-gray-200 p-4">
                <div class="flex space-x-4">
                    <input 
                        type="text" 
                        id="message-input" 
                        placeholder="Escribe tu mensaje..."
                        class="flex-1 border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        disabled
                    >
                    <button 
                        id="send-btn" 
                        class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition disabled:bg-gray-400"
                        disabled
                    >
                        Enviar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center">
        <div class="bg-white p-6 rounded-lg w-96">
            <h3 class="text-lg font-semibold mb-4">Configuración</h3>
            
            <!-- Configuration Display Mode -->
            <div id="config-display" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700">API Key</label>
                    <div class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-50 text-gray-700">
                        <span id="api-key-display">No configurada</span>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Bot ID</label>
                    <div class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-50 text-gray-700">
                        <span id="bot-id-display">No configurado</span>
                    </div>
                </div>
                <div class="mt-6 flex justify-end space-x-3">
                    <button id="cancel-settings-display" class="px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50">
                        Cerrar
                    </button>
                    <button id="edit-settings" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                        Editar
                    </button>
                </div>
            </div>

            <!-- Configuration Edit Mode -->
            <div id="config-edit" class="space-y-4 hidden">
                <div>
                    <label class="block text-sm font-medium text-gray-700">API Key</label>
                    <input 
                        type="password" 
                        id="api-key-input" 
                        class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        placeholder="Ingresa tu API Key"
                    >
                    <button 
                        type="button" 
                        id="toggle-api-key" 
                        class="mt-1 text-xs text-blue-500 hover:text-blue-700"
                        onclick="togglePasswordVisibility('api-key-input', this)"
                    >
                        Mostrar
                    </button>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Bot ID</label>
                    <input 
                        type="number" 
                        id="bot-id-input" 
                        class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        placeholder="ID del bot"
                    >
                </div>
                <div class="mt-6 flex justify-end space-x-3">
                    <button id="cancel-settings-edit" class="px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50">
                        Cancelar
                    </button>
                    <button id="save-settings" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                        Guardar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="/assets/chat.js"></script>

    <script>
        // Function to toggle password visibility
        function togglePasswordVisibility(inputId, button) {
            const input = document.getElementById(inputId);
            if (input.type === 'password') {
                input.type = 'text';
                button.textContent = 'Ocultar';
            } else {
                input.type = 'password';
                button.textContent = 'Mostrar';
            }
        }
    </script>

    <!-- Settings button (floating) -->
    <button 
        onclick="document.getElementById('settings-modal').classList.remove('hidden'); document.getElementById('settings-modal').classList.add('flex');"
        class="fixed bottom-4 right-4 bg-gray-800 text-white p-3 rounded-full shadow-lg hover:bg-gray-700 transition"
        title="Configuración"
    >
        ⚙️
    </button>
</body>
</html>
